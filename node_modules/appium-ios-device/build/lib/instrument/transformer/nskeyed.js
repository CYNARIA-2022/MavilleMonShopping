"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.XCTestConfiguration = exports.NSUUID = exports.NSURL = exports.NSDate = exports.BaseArchiveHandler = void 0;
exports.archive = archive;
exports.unarchive = unarchive;
exports.updateNSKeyedArchiveClass = updateNSKeyedArchiveClass;
require("source-map-support/register");
var _bplistParser = _interopRequireDefault(require("bplist-parser"));
var _bplistCreator = _interopRequireDefault(require("bplist-creator"));
var _uuid = require("uuid");
var _lodash = _interopRequireDefault(require("lodash"));
var _nodeUtil = require("node:util");
const NSKEYED_ARCHIVE_VERSION = 100_000;
const NULL_UID = new _bplistParser.default.UID(0);
const CYCLE_TOKEN = 'CycleToken';
const PRIMITIVE_TYPES = ['Number', 'String', 'Boolean', 'UID', 'Buffer'];
const NON_ENCODABLE_TYPES = ['number', 'boolean'];
const NSKEYEDARCHIVER = 'NSKeyedArchiver';
const UNIX2APPLE_TIMESTAMP_SECOND = 978307200;
const FORMAT_VERSION = 'formatVersion';
const NS_OBJECT = 'NSObject';
class ArchivedObject {
  constructor(object, unarchiver) {
    this.object = object;
    this._unarchiver = unarchiver;
  }
  decodeIndex(index) {
    return this._unarchiver.decodeObject(index);
  }
  decode(key) {
    return this._unarchiver.decodeKey(this.object, key);
  }
}
class ArchivingObject {
  constructor(object, archiver) {
    this._archiveObj = object;
    this._archiver = archiver;
  }
  encode(key, val) {
    this._archiveObj[key] = this._archiver.encode(val);
  }
}
class BaseArchiveHandler {
  additionClasses = [];
  decodeArchive(archive) {
    throw new Error(`Did not know how to decode the object`);
  }
  encodeArchive(obj, archive) {
    throw new Error(`Did not know how to encode the object`);
  }
}
exports.BaseArchiveHandler = BaseArchiveHandler;
class DictArchive extends BaseArchiveHandler {
  decodeArchive(archive) {
    const keyUids = archive.decode('NS.keys');
    const valUids = archive.decode('NS.objects');
    const d = {};
    for (let i = 0; i < keyUids.length; i++) {
      const key = archive.decodeIndex(keyUids[i]);
      d[key] = archive.decodeIndex(valUids[i]);
    }
    return d;
  }
}
class ListArchive extends BaseArchiveHandler {
  decodeArchive(archive) {
    const uids = archive.decode('NS.objects');
    return uids.map(archive.decodeIndex.bind(archive));
  }
}
class DTTapMessagePlist extends BaseArchiveHandler {
  decodeArchive(archive) {
    return archive.decode('DTTapMessagePlist');
  }
}
class NSError extends BaseArchiveHandler {
  decodeArchive(archive) {
    return {
      $class: 'NSError',
      domain: archive.decode('NSDomain'),
      userinfo: archive.decode('NSUserInfo'),
      code: archive.decode('NSCode')
    };
  }
}
class NSException extends BaseArchiveHandler {
  decodeArchive(archive) {
    return {
      $class: 'NSException',
      reason: archive.decode('NS.reason'),
      userinfo: archive.decode('userinfo'),
      name: archive.decode('NS.name')
    };
  }
}
class NSURL extends BaseArchiveHandler {
  constructor(base, relative) {
    super();
    this._base = base;
    this._relative = relative;
    this.additionClasses = [NS_OBJECT];
  }
  decodeArchive(archive) {
    return {
      $class: 'NSURL',
      base: archive.decode('NS.base'),
      relative: archive.decode('NS.relative')
    };
  }
  encodeArchive(obj, archive) {
    archive.encode('NS.base', obj._base);
    archive.encode('NS.relative', obj._relative);
  }
}
exports.NSURL = NSURL;
class NSDate extends BaseArchiveHandler {
  constructor(data) {
    super();
    this._data = data;
  }
  decodeArchive(archive) {
    return UNIX2APPLE_TIMESTAMP_SECOND + archive.decode('NS.time');
  }
  encodeArchive(obj, archive) {
    archive.encode('NS.time', obj._data - UNIX2APPLE_TIMESTAMP_SECOND);
  }
}
exports.NSDate = NSDate;
class NSMutableString extends BaseArchiveHandler {
  decodeArchive(archive) {
    return archive.decode('NS.string');
  }
}
class NSMutableData extends BaseArchiveHandler {
  decodeArchive(archive) {
    return archive.decode('NS.data');
  }
}
class NSUUID extends BaseArchiveHandler {
  constructor(data) {
    super();
    this._data = data;
    this.additionClasses = [NS_OBJECT];
  }
  decodeArchive(archive) {
    return (0, _uuid.stringify)(archive.decode('NS.uuidbytes'));
  }
  encodeArchive(obj, archive) {
    archive._archiveObj['NS.uuidbytes'] = Buffer.from((0, _uuid.parse)(obj._data).buffer);
  }
}
exports.NSUUID = NSUUID;
class XCTCapabilities extends BaseArchiveHandler {
  decodeArchive(archive) {
    return archive.decode('capabilities-dictionary');
  }
}
class NSIgnore extends BaseArchiveHandler {
  decodeArchive() {
    return null;
  }
}
class NSNull extends BaseArchiveHandler {
  constructor() {
    super();
    this.additionClasses = [NS_OBJECT];
  }
  decodeArchive() {
    return null;
  }
}
class XCTestConfiguration extends BaseArchiveHandler {
  static _default = {
    aggregateStatisticsBeforeCrash: {
      XCSuiteRecordsKey: {}
    },
    automationFrameworkPath: '/Developer/Library/PrivateFrameworks/XCTAutomationSupport.framework',
    baselineFileRelativePath: undefined,
    baselineFileURL: undefined,
    defaultTestExecutionTimeAllowance: undefined,
    disablePerformanceMetrics: false,
    emitOSLogs: false,
    formatVersion: 2,
    gatherLocalizableStringsData: false,
    initializeForUITesting: true,
    maximumTestExecutionTimeAllowance: undefined,
    productModuleName: 'WebDriverAgentRunner',
    randomExecutionOrderingSeed: undefined,
    reportActivities: true,
    reportResultsToIDE: true,
    systemAttachmentLifetime: 2,
    targetApplicationArguments: [],
    targetApplicationBundleID: undefined,
    targetApplicationEnvironment: undefined,
    targetApplicationPath: '/KEEP-THIS-NOT-EMPTY/KEEP-THIS-NOT-EMPTY',
    testApplicationDependencies: {},
    testApplicationUserOverrides: undefined,
    testBundleRelativePath: undefined,
    testExecutionOrdering: 0,
    testTimeoutsEnabled: false,
    testsDrivenByIDE: false,
    testsMustRunOnMainThread: true,
    testsToRun: undefined,
    testsToSkip: undefined,
    treatMissingBaselinesAsFailures: false,
    userAttachmentLifetime: 1
  };
  constructor(data) {
    super();
    if (!data.testBundleURL) {
      throw new TypeError('testBundleURL cannot be empty');
    }
    if (!data.sessionIdentifier) {
      throw new TypeError('sessionIdentifier cannot be empty');
    }
    if (typeof data.testBundleURL === 'string') {
      data.testBundleURL = new NSURL(undefined, data.testBundleURL);
    }
    if (!(data.testBundleURL instanceof NSURL)) {
      throw new TypeError(`Expected testBundleURL to be a valid NSURL instance, got ${data.testBundleURL.constructor.name} instead`);
    }
    if (typeof data.sessionIdentifier === 'string') {
      data.sessionIdentifier = new NSUUID(data.sessionIdentifier);
    }
    if (!(data.sessionIdentifier instanceof NSUUID)) {
      throw new TypeError(`Expected sessionIdentifier to be a valid NSUUID instance, got ${data.sessionIdentifier.constructor.name} instead`);
    }
    this._data = {
      ...XCTestConfiguration._default,
      ...data
    };
  }
  getBytes() {
    return archive(this);
  }
}
exports.XCTestConfiguration = XCTestConfiguration;
class XCActivityRecord extends BaseArchiveHandler {
  static _keys = ['activityType', 'attachments', 'finish', 'start', 'title', 'uuid'];
  decodeArchive(archive) {
    return XCActivityRecord._keys.reduce((acc, key) => {
      acc[key] = archive.decode(key);
      return acc;
    }, {});
  }
}
const UNARCHIVE_CLASS_MAP = {
  DTTapMessagePlist,
  DTSysmonTapMessage: DTTapMessagePlist,
  DTTapHeartbeatMessage: DTTapMessagePlist,
  DTTapMessageArchive: DTTapMessagePlist,
  DTKTraceTapMessage: DTTapMessagePlist,
  ErrorArchive: NSError,
  ExceptionArchive: NSException,
  NSDictionary: DictArchive,
  NSMutableDictionary: DictArchive,
  NSArray: ListArchive,
  NSMutableArray: ListArchive,
  NSMutableSet: ListArchive,
  NSSet: ListArchive,
  NSDate,
  NSError,
  NSException,
  NSMutableString,
  NSMutableData,
  NSNull,
  NSUUID,
  NSURL,
  XCActivityRecord,
  XCTCapabilities,
  XCTestConfiguration
};
class Unarchive {
  constructor(inputBytes) {
    this.input = inputBytes;
    this.unpackedUids = {};
    this.topUID = NULL_UID;
    this.objects = [];
  }
  unpackArchiveHeader() {
    const plist = _bplistParser.default.parseBuffer(this.input)[0];
    if (plist.$archiver !== NSKEYEDARCHIVER) {
      throw new Error(`unsupported encoder: ${plist.$archiver}`);
    }
    if (plist.$version !== NSKEYED_ARCHIVE_VERSION) {
      throw new Error(`expected ${NSKEYED_ARCHIVE_VERSION}, got ${plist.$version}`);
    }
    const top = plist.$top;
    const topUID = top.root;
    if (!topUID) {
      throw new Error(`top object did not have a UID! dump: ${JSON.stringify(top)}`);
    }
    this.topUID = topUID;
    this.objects = plist.$objects;
  }
  classForUid(index) {
    const meta = this.objects[index.UID];
    const name = meta.$classname;
    const klass = UNARCHIVE_CLASS_MAP[name] ?? NSIgnore;
    return klass;
  }
  decodeKey(obj, key) {
    const val = obj[key];
    return _lodash.default.isNil(val === null || val === void 0 ? void 0 : val.UID) ? val : this.decodeObject(val);
  }
  decodeObject(index) {
    if (index === NULL_UID) {
      return null;
    }
    const obj = this.unpackedUids[index];
    if (obj === CYCLE_TOKEN) {
      throw new Error(`archive has a cycle with ${index}`);
    }
    if (!_lodash.default.isUndefined(obj)) {
      return obj;
    }
    const rawObj = this.objects[index.UID];
    this.unpackedUids[index.UID] = CYCLE_TOKEN;
    if (!(rawObj !== null && rawObj !== void 0 && rawObj.$class)) {
      this.unpackedUids[index.UID] = obj;
      return rawObj;
    }
    const klass = this.classForUid(rawObj.$class);
    const klassObj = new klass().decodeArchive(new ArchivedObject(rawObj, this));
    this.unpackedUids[index.UID] = klassObj;
    return klassObj;
  }
  toObject() {
    this.unpackArchiveHeader();
    return this.decodeObject(this.topUID);
  }
}
class Archive {
  constructor(inputObject) {
    this.input = inputObject;
    this.objects = ['$null'];
  }
  uidForArchiver(archiver, ...addition) {
    const val = new _bplistParser.default.UID(this.objects.length);
    this.objects.push({
      $classes: [archiver, ...addition],
      $classname: archiver
    });
    return val;
  }
  archive(obj) {
    if (_lodash.default.isUndefined(obj) || _lodash.default.isNull(obj)) {
      return NULL_UID;
    }
    const index = new _bplistParser.default.UID(this.objects.length);
    if (PRIMITIVE_TYPES.includes(obj.constructor.name)) {
      this.objects.push(obj);
      return index;
    }
    const archiveObj = {};
    this.objects.push(archiveObj);
    this.encodeTopLevel(obj, archiveObj);
    return index;
  }
  encode(val) {
    if (NON_ENCODABLE_TYPES.includes(typeof val)) {
      return val;
    }
    return this.archive(val);
  }
  encodeTopLevel(obj, archiveObj) {
    if (obj instanceof Array) {
      return this.encodeArray(obj, archiveObj);
    } else if (obj instanceof Set) {
      return this.encodeSet(obj, archiveObj);
    } else if (obj instanceof XCTestConfiguration) {
      return this.encodeXCTestConfiguration(obj, archiveObj);
    } else if (obj instanceof Object) {
      const objName = obj.constructor.name;
      if (objName in UNARCHIVE_CLASS_MAP) {
        obj.encodeArchive(obj, new ArchivingObject(archiveObj, this));
        archiveObj.$class = this.uidForArchiver(objName, ...(obj.additionClasses ?? []));
      } else {
        return this.encodeDict(obj, archiveObj);
      }
    } else {
      throw new Error(`Unable to encode types: ${(0, _nodeUtil.format)('%O', obj)}`);
    }
  }
  encodeArray(objs, archiveObj) {
    archiveObj.$class = this.uidForArchiver('NSArray', NS_OBJECT);
    archiveObj['NS.objects'] = objs.map(this.archive.bind(this));
  }
  encodeSet(objs, archiveObj) {
    archiveObj.$class = this.uidForArchiver('NSSet', NS_OBJECT);
    archiveObj['NS.objects'] = objs.map(this.archive.bind(this));
  }
  encodeDict(obj, archiveObj) {
    archiveObj['NS.keys'] = _lodash.default.keys(obj).map(this.archive.bind(this));
    archiveObj['NS.objects'] = _lodash.default.values(obj).map(this.archive.bind(this));
    archiveObj.$class = this.uidForArchiver('NSDictionary', NS_OBJECT);
  }
  encodeXCTestConfiguration(obj, archiveObj) {
    archiveObj.$class = this.uidForArchiver('XCTestConfiguration', NS_OBJECT);
    _lodash.default.entries(obj._data).forEach(([key, value]) => archiveObj[key] = key === FORMAT_VERSION ? this.archive(value) : this.encode(value));
  }
  toBytes() {
    if (this.objects.length === 1) {
      this.archive(this.input);
    }
    const d = {
      $version: NSKEYED_ARCHIVE_VERSION,
      $archiver: NSKEYEDARCHIVER,
      $top: {
        root: new _bplistParser.default.UID(1)
      },
      $objects: this.objects
    };
    return (0, _bplistCreator.default)(d);
  }
}
function archive(inputObject) {
  return new Archive(inputObject).toBytes();
}
function unarchive(inputBytes) {
  return new Unarchive(inputBytes).toObject();
}
function updateNSKeyedArchiveClass(name, subClass) {
  var _subClass$prototype, _subClass$prototype2;
  if (!_lodash.default.isFunction((_subClass$prototype = subClass.prototype) === null || _subClass$prototype === void 0 ? void 0 : _subClass$prototype.decodeArchive) && !_lodash.default.isFunction((_subClass$prototype2 = subClass.prototype) === null || _subClass$prototype2 === void 0 ? void 0 : _subClass$prototype2.encodeArchive)) {
    throw new Error('subClass must have decodeArchive or encodeArchive methods');
  }
  if (!(name in UNARCHIVE_CLASS_MAP)) {
    UNARCHIVE_CLASS_MAP[name] = subClass;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYnBsaXN0UGFyc2VyIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfYnBsaXN0Q3JlYXRvciIsIl91dWlkIiwiX2xvZGFzaCIsIl9ub2RlVXRpbCIsIk5TS0VZRURfQVJDSElWRV9WRVJTSU9OIiwiTlVMTF9VSUQiLCJwbGlzdGxpYiIsIlVJRCIsIkNZQ0xFX1RPS0VOIiwiUFJJTUlUSVZFX1RZUEVTIiwiTk9OX0VOQ09EQUJMRV9UWVBFUyIsIk5TS0VZRURBUkNISVZFUiIsIlVOSVgyQVBQTEVfVElNRVNUQU1QX1NFQ09ORCIsIkZPUk1BVF9WRVJTSU9OIiwiTlNfT0JKRUNUIiwiQXJjaGl2ZWRPYmplY3QiLCJjb25zdHJ1Y3RvciIsIm9iamVjdCIsInVuYXJjaGl2ZXIiLCJfdW5hcmNoaXZlciIsImRlY29kZUluZGV4IiwiaW5kZXgiLCJkZWNvZGVPYmplY3QiLCJkZWNvZGUiLCJrZXkiLCJkZWNvZGVLZXkiLCJBcmNoaXZpbmdPYmplY3QiLCJhcmNoaXZlciIsIl9hcmNoaXZlT2JqIiwiX2FyY2hpdmVyIiwiZW5jb2RlIiwidmFsIiwiQmFzZUFyY2hpdmVIYW5kbGVyIiwiYWRkaXRpb25DbGFzc2VzIiwiZGVjb2RlQXJjaGl2ZSIsImFyY2hpdmUiLCJFcnJvciIsImVuY29kZUFyY2hpdmUiLCJvYmoiLCJleHBvcnRzIiwiRGljdEFyY2hpdmUiLCJrZXlVaWRzIiwidmFsVWlkcyIsImQiLCJpIiwibGVuZ3RoIiwiTGlzdEFyY2hpdmUiLCJ1aWRzIiwibWFwIiwiYmluZCIsIkRUVGFwTWVzc2FnZVBsaXN0IiwiTlNFcnJvciIsIiRjbGFzcyIsImRvbWFpbiIsInVzZXJpbmZvIiwiY29kZSIsIk5TRXhjZXB0aW9uIiwicmVhc29uIiwibmFtZSIsIk5TVVJMIiwiYmFzZSIsInJlbGF0aXZlIiwiX2Jhc2UiLCJfcmVsYXRpdmUiLCJOU0RhdGUiLCJkYXRhIiwiX2RhdGEiLCJOU011dGFibGVTdHJpbmciLCJOU011dGFibGVEYXRhIiwiTlNVVUlEIiwidXVpZFN0cmluZ2lmeSIsIkJ1ZmZlciIsImZyb20iLCJ1dWlkUGFyc2UiLCJidWZmZXIiLCJYQ1RDYXBhYmlsaXRpZXMiLCJOU0lnbm9yZSIsIk5TTnVsbCIsIlhDVGVzdENvbmZpZ3VyYXRpb24iLCJfZGVmYXVsdCIsImFnZ3JlZ2F0ZVN0YXRpc3RpY3NCZWZvcmVDcmFzaCIsIlhDU3VpdGVSZWNvcmRzS2V5IiwiYXV0b21hdGlvbkZyYW1ld29ya1BhdGgiLCJiYXNlbGluZUZpbGVSZWxhdGl2ZVBhdGgiLCJ1bmRlZmluZWQiLCJiYXNlbGluZUZpbGVVUkwiLCJkZWZhdWx0VGVzdEV4ZWN1dGlvblRpbWVBbGxvd2FuY2UiLCJkaXNhYmxlUGVyZm9ybWFuY2VNZXRyaWNzIiwiZW1pdE9TTG9ncyIsImZvcm1hdFZlcnNpb24iLCJnYXRoZXJMb2NhbGl6YWJsZVN0cmluZ3NEYXRhIiwiaW5pdGlhbGl6ZUZvclVJVGVzdGluZyIsIm1heGltdW1UZXN0RXhlY3V0aW9uVGltZUFsbG93YW5jZSIsInByb2R1Y3RNb2R1bGVOYW1lIiwicmFuZG9tRXhlY3V0aW9uT3JkZXJpbmdTZWVkIiwicmVwb3J0QWN0aXZpdGllcyIsInJlcG9ydFJlc3VsdHNUb0lERSIsInN5c3RlbUF0dGFjaG1lbnRMaWZldGltZSIsInRhcmdldEFwcGxpY2F0aW9uQXJndW1lbnRzIiwidGFyZ2V0QXBwbGljYXRpb25CdW5kbGVJRCIsInRhcmdldEFwcGxpY2F0aW9uRW52aXJvbm1lbnQiLCJ0YXJnZXRBcHBsaWNhdGlvblBhdGgiLCJ0ZXN0QXBwbGljYXRpb25EZXBlbmRlbmNpZXMiLCJ0ZXN0QXBwbGljYXRpb25Vc2VyT3ZlcnJpZGVzIiwidGVzdEJ1bmRsZVJlbGF0aXZlUGF0aCIsInRlc3RFeGVjdXRpb25PcmRlcmluZyIsInRlc3RUaW1lb3V0c0VuYWJsZWQiLCJ0ZXN0c0RyaXZlbkJ5SURFIiwidGVzdHNNdXN0UnVuT25NYWluVGhyZWFkIiwidGVzdHNUb1J1biIsInRlc3RzVG9Ta2lwIiwidHJlYXRNaXNzaW5nQmFzZWxpbmVzQXNGYWlsdXJlcyIsInVzZXJBdHRhY2htZW50TGlmZXRpbWUiLCJ0ZXN0QnVuZGxlVVJMIiwiVHlwZUVycm9yIiwic2Vzc2lvbklkZW50aWZpZXIiLCJnZXRCeXRlcyIsIlhDQWN0aXZpdHlSZWNvcmQiLCJfa2V5cyIsInJlZHVjZSIsImFjYyIsIlVOQVJDSElWRV9DTEFTU19NQVAiLCJEVFN5c21vblRhcE1lc3NhZ2UiLCJEVFRhcEhlYXJ0YmVhdE1lc3NhZ2UiLCJEVFRhcE1lc3NhZ2VBcmNoaXZlIiwiRFRLVHJhY2VUYXBNZXNzYWdlIiwiRXJyb3JBcmNoaXZlIiwiRXhjZXB0aW9uQXJjaGl2ZSIsIk5TRGljdGlvbmFyeSIsIk5TTXV0YWJsZURpY3Rpb25hcnkiLCJOU0FycmF5IiwiTlNNdXRhYmxlQXJyYXkiLCJOU011dGFibGVTZXQiLCJOU1NldCIsIlVuYXJjaGl2ZSIsImlucHV0Qnl0ZXMiLCJpbnB1dCIsInVucGFja2VkVWlkcyIsInRvcFVJRCIsIm9iamVjdHMiLCJ1bnBhY2tBcmNoaXZlSGVhZGVyIiwicGxpc3QiLCJwYXJzZUJ1ZmZlciIsIiRhcmNoaXZlciIsIiR2ZXJzaW9uIiwidG9wIiwiJHRvcCIsInJvb3QiLCJKU09OIiwic3RyaW5naWZ5IiwiJG9iamVjdHMiLCJjbGFzc0ZvclVpZCIsIm1ldGEiLCIkY2xhc3NuYW1lIiwia2xhc3MiLCJfIiwiaXNOaWwiLCJpc1VuZGVmaW5lZCIsInJhd09iaiIsImtsYXNzT2JqIiwidG9PYmplY3QiLCJBcmNoaXZlIiwiaW5wdXRPYmplY3QiLCJ1aWRGb3JBcmNoaXZlciIsImFkZGl0aW9uIiwicHVzaCIsIiRjbGFzc2VzIiwiaXNOdWxsIiwiaW5jbHVkZXMiLCJhcmNoaXZlT2JqIiwiZW5jb2RlVG9wTGV2ZWwiLCJBcnJheSIsImVuY29kZUFycmF5IiwiU2V0IiwiZW5jb2RlU2V0IiwiZW5jb2RlWENUZXN0Q29uZmlndXJhdGlvbiIsIk9iamVjdCIsIm9iak5hbWUiLCJlbmNvZGVEaWN0Iiwic3RyaW5nRm9ybWF0Iiwib2JqcyIsImtleXMiLCJ2YWx1ZXMiLCJlbnRyaWVzIiwiZm9yRWFjaCIsInZhbHVlIiwidG9CeXRlcyIsImJwbGlzdENyZWF0ZSIsInVuYXJjaGl2ZSIsInVwZGF0ZU5TS2V5ZWRBcmNoaXZlQ2xhc3MiLCJzdWJDbGFzcyIsIl9zdWJDbGFzcyRwcm90b3R5cGUiLCJfc3ViQ2xhc3MkcHJvdG90eXBlMiIsImlzRnVuY3Rpb24iLCJwcm90b3R5cGUiXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9saWIvaW5zdHJ1bWVudC90cmFuc2Zvcm1lci9uc2tleWVkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwbGlzdGxpYiBmcm9tICdicGxpc3QtcGFyc2VyJztcbmltcG9ydCBicGxpc3RDcmVhdGUgZnJvbSAnYnBsaXN0LWNyZWF0b3InO1xuaW1wb3J0IHsgcGFyc2UgYXMgdXVpZFBhcnNlLCBzdHJpbmdpZnkgYXMgdXVpZFN0cmluZ2lmeSB9IGZyb20gJ3V1aWQnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IGZvcm1hdCBhcyBzdHJpbmdGb3JtYXQgfSBmcm9tICdub2RlOnV0aWwnO1xuXG5jb25zdCBOU0tFWUVEX0FSQ0hJVkVfVkVSU0lPTiA9IDEwMF8wMDA7XG5jb25zdCBOVUxMX1VJRCA9IG5ldyBwbGlzdGxpYi5VSUQoMCk7XG5jb25zdCBDWUNMRV9UT0tFTiA9ICdDeWNsZVRva2VuJztcbmNvbnN0IFBSSU1JVElWRV9UWVBFUyA9IFsnTnVtYmVyJywgJ1N0cmluZycsICdCb29sZWFuJywgJ1VJRCcsICdCdWZmZXInXTtcbmNvbnN0IE5PTl9FTkNPREFCTEVfVFlQRVMgPSBbJ251bWJlcicsICdib29sZWFuJ107XG5jb25zdCBOU0tFWUVEQVJDSElWRVIgPSAnTlNLZXllZEFyY2hpdmVyJztcbmNvbnN0IFVOSVgyQVBQTEVfVElNRVNUQU1QX1NFQ09ORCA9IDk3ODMwNzIwMDtcbmNvbnN0IEZPUk1BVF9WRVJTSU9OID0gJ2Zvcm1hdFZlcnNpb24nO1xuY29uc3QgTlNfT0JKRUNUID0gJ05TT2JqZWN0JztcblxuXG5jbGFzcyBBcmNoaXZlZE9iamVjdCB7XG4gIC8qKlxuICAgKiBTdGF0ZWZ1bCB3cmFwcGVyIGFyb3VuZCBBcmNoaXZlIGZvciBhbiBvYmplY3QgYmVpbmcgYXJjaGl2ZWQuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3RcbiAgICogQHBhcmFtIHtVbmFyY2hpdmV9IHVuYXJjaGl2ZXJcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICBjb25zdHJ1Y3RvcihvYmplY3QsIHVuYXJjaGl2ZXIpIHtcbiAgICB0aGlzLm9iamVjdCA9IG9iamVjdDtcbiAgICB0aGlzLl91bmFyY2hpdmVyID0gdW5hcmNoaXZlcjtcbiAgfVxuXG4gIGRlY29kZUluZGV4KGluZGV4KSB7XG4gICAgcmV0dXJuIHRoaXMuX3VuYXJjaGl2ZXIuZGVjb2RlT2JqZWN0KGluZGV4KTtcbiAgfVxuXG4gIGRlY29kZShrZXkpIHtcbiAgICByZXR1cm4gdGhpcy5fdW5hcmNoaXZlci5kZWNvZGVLZXkodGhpcy5vYmplY3QsIGtleSk7XG4gIH1cbn1cblxuY2xhc3MgQXJjaGl2aW5nT2JqZWN0IHtcbiAgLyoqXG4gICAqIFN0YXRlZnVsIHdyYXBwZXIgYXJvdW5kIFVuYXJjaGl2ZSBmb3IgYW4gYXJjaGl2ZWQgb2JqZWN0XG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3RcbiAgICogQHBhcmFtIHtBcmNoaXZlfSBhcmNoaXZlclxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGNvbnN0cnVjdG9yKG9iamVjdCwgYXJjaGl2ZXIpIHtcbiAgICB0aGlzLl9hcmNoaXZlT2JqID0gb2JqZWN0O1xuICAgIHRoaXMuX2FyY2hpdmVyID0gYXJjaGl2ZXI7XG4gIH1cblxuICBlbmNvZGUoa2V5LCB2YWwpIHtcbiAgICB0aGlzLl9hcmNoaXZlT2JqW2tleV0gPSB0aGlzLl9hcmNoaXZlci5lbmNvZGUodmFsKTtcbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgY2xhc3MgbXVzdCBiZSBpbmhlcml0ZWQgd2hlbiBjcmVhdGluZyBhbiBhcmNoaXZlL3VuYXJjaGl2ZSBzdWJjbGFzc1xuICogQW5kIHlvdSBuZWVkIHRvIGNhbGwgYHVwZGF0ZU5TS2V5ZWRBcmNoaXZlQ2xhc3NgIGFkZCBzdWJjbGFzcyB0byBhcmNoaXZlL3VuYXJjaGl2ZSBvYmplY3RcbiAqL1xuY2xhc3MgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgLyoqXG4gICAqIHNvbWUgb2YgdGhlIGNsYXNzZXMgbWF5IGhhdmUgdG8gYWRkICdOU09iamVjdCcgb3IgbWF5YmUgbW9yZSBpbiAkY2xhc3NlcyB3aGlsZSBlbmNvZGluZy5cbiAgICovXG4gIGFkZGl0aW9uQ2xhc3NlcyA9IFtdO1xuICAvKipcbiAgICogQHBhcmFtIHtBcmNoaXZlZE9iamVjdH0gYXJjaGl2ZVxuICAgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG4gIGRlY29kZUFyY2hpdmUoYXJjaGl2ZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgRGlkIG5vdCBrbm93IGhvdyB0byBkZWNvZGUgdGhlIG9iamVjdGApO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3NcbiAgICogQHBhcmFtIHtBcmNoaXZpbmdPYmplY3R9IGFyY2hpdmVcbiAgICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuICBlbmNvZGVBcmNoaXZlKG9iaiwgYXJjaGl2ZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgRGlkIG5vdCBrbm93IGhvdyB0byBlbmNvZGUgdGhlIG9iamVjdGApO1xuICB9XG59XG5cbi8qKlxuICogXCJEZWxlZ2F0ZSBmb3IgcGFja2luZy91bnBhY2tpbmcgTlMoTXV0YWJsZSlEaWN0aW9uYXJ5IG9iamVjdHNcIlxuICovXG5jbGFzcyBEaWN0QXJjaGl2ZSBleHRlbmRzIEJhc2VBcmNoaXZlSGFuZGxlciB7XG4gIGRlY29kZUFyY2hpdmUoYXJjaGl2ZSkge1xuICAgIGNvbnN0IGtleVVpZHMgPSBhcmNoaXZlLmRlY29kZSgnTlMua2V5cycpO1xuICAgIGNvbnN0IHZhbFVpZHMgPSBhcmNoaXZlLmRlY29kZSgnTlMub2JqZWN0cycpO1xuICAgIGNvbnN0IGQgPSB7fTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleVVpZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGtleSA9IGFyY2hpdmUuZGVjb2RlSW5kZXgoa2V5VWlkc1tpXSk7XG4gICAgICBkW2tleV0gPSBhcmNoaXZlLmRlY29kZUluZGV4KHZhbFVpZHNbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gZDtcbiAgfVxufVxuXG4vKipcbiAqIERlbGVnYXRlIGZvciBwYWNraW5nL3VucGFja2luZyBOUyhNdXRhYmxlKUFycmF5IG9iamVjdHNcbiAqL1xuY2xhc3MgTGlzdEFyY2hpdmUgZXh0ZW5kcyBCYXNlQXJjaGl2ZUhhbmRsZXIge1xuICBkZWNvZGVBcmNoaXZlKGFyY2hpdmUpIHtcbiAgICBjb25zdCB1aWRzID0gYXJjaGl2ZS5kZWNvZGUoJ05TLm9iamVjdHMnKTtcbiAgICByZXR1cm4gdWlkcy5tYXAoYXJjaGl2ZS5kZWNvZGVJbmRleC5iaW5kKGFyY2hpdmUpKTtcbiAgfVxufVxuXG5jbGFzcyBEVFRhcE1lc3NhZ2VQbGlzdCBleHRlbmRzIEJhc2VBcmNoaXZlSGFuZGxlciB7XG4gIGRlY29kZUFyY2hpdmUoYXJjaGl2ZSkge1xuICAgIHJldHVybiBhcmNoaXZlLmRlY29kZSgnRFRUYXBNZXNzYWdlUGxpc3QnKTtcbiAgfVxufVxuXG5jbGFzcyBOU0Vycm9yIGV4dGVuZHMgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgZGVjb2RlQXJjaGl2ZShhcmNoaXZlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICRjbGFzczogJ05TRXJyb3InLFxuICAgICAgZG9tYWluOiBhcmNoaXZlLmRlY29kZSgnTlNEb21haW4nKSxcbiAgICAgIHVzZXJpbmZvOiBhcmNoaXZlLmRlY29kZSgnTlNVc2VySW5mbycpLFxuICAgICAgY29kZTogYXJjaGl2ZS5kZWNvZGUoJ05TQ29kZScpXG4gICAgfTtcbiAgfVxufVxuXG5jbGFzcyBOU0V4Y2VwdGlvbiBleHRlbmRzIEJhc2VBcmNoaXZlSGFuZGxlciB7XG4gIGRlY29kZUFyY2hpdmUoYXJjaGl2ZSkge1xuICAgIHJldHVybiB7XG4gICAgICAkY2xhc3M6ICdOU0V4Y2VwdGlvbicsXG4gICAgICByZWFzb246IGFyY2hpdmUuZGVjb2RlKCdOUy5yZWFzb24nKSxcbiAgICAgIHVzZXJpbmZvOiBhcmNoaXZlLmRlY29kZSgndXNlcmluZm8nKSxcbiAgICAgIG5hbWU6IGFyY2hpdmUuZGVjb2RlKCdOUy5uYW1lJylcbiAgICB9O1xuICB9XG59XG5cbmNsYXNzIE5TVVJMIGV4dGVuZHMgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7Kn0gYmFzZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gcmVsYXRpdmUgdXN1YWxseSBpb3MgZGV2aWNlIHJlbGF0aXZlIHBhdGggZS5nOiBmaWxlOi8veHgvXG4gICAqL1xuICBjb25zdHJ1Y3RvcihiYXNlLCByZWxhdGl2ZSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fYmFzZSA9IGJhc2U7XG4gICAgdGhpcy5fcmVsYXRpdmUgPSByZWxhdGl2ZTtcbiAgICB0aGlzLmFkZGl0aW9uQ2xhc3NlcyA9IFtOU19PQkpFQ1RdO1xuICB9XG5cbiAgZGVjb2RlQXJjaGl2ZShhcmNoaXZlKSB7XG4gICAgcmV0dXJuIHsgJGNsYXNzOiAnTlNVUkwnLCBiYXNlOiBhcmNoaXZlLmRlY29kZSgnTlMuYmFzZScpLCByZWxhdGl2ZTogYXJjaGl2ZS5kZWNvZGUoJ05TLnJlbGF0aXZlJykgfTtcbiAgfVxuXG4gIGVuY29kZUFyY2hpdmUob2JqLCBhcmNoaXZlKSB7XG4gICAgYXJjaGl2ZS5lbmNvZGUoJ05TLmJhc2UnLCBvYmouX2Jhc2UpO1xuICAgIGFyY2hpdmUuZW5jb2RlKCdOUy5yZWxhdGl2ZScsIG9iai5fcmVsYXRpdmUpO1xuICB9XG59XG5cbmNsYXNzIE5TRGF0ZSBleHRlbmRzIEJhc2VBcmNoaXZlSGFuZGxlciB7XG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gZGF0YSB0aW1lc3RhbXAgaW4gc2Vjb25kc1xuICAgKi9cbiAgY29uc3RydWN0b3IoZGF0YSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gIH1cblxuICBkZWNvZGVBcmNoaXZlKGFyY2hpdmUpIHtcbiAgICByZXR1cm4gVU5JWDJBUFBMRV9USU1FU1RBTVBfU0VDT05EICsgYXJjaGl2ZS5kZWNvZGUoJ05TLnRpbWUnKTtcbiAgfVxuXG4gIGVuY29kZUFyY2hpdmUob2JqLCBhcmNoaXZlKSB7XG4gICAgYXJjaGl2ZS5lbmNvZGUoJ05TLnRpbWUnLCBvYmouX2RhdGEgLSBVTklYMkFQUExFX1RJTUVTVEFNUF9TRUNPTkQpO1xuICB9XG59XG5cbmNsYXNzIE5TTXV0YWJsZVN0cmluZyBleHRlbmRzIEJhc2VBcmNoaXZlSGFuZGxlciB7XG4gIGRlY29kZUFyY2hpdmUoYXJjaGl2ZSkge1xuICAgIHJldHVybiBhcmNoaXZlLmRlY29kZSgnTlMuc3RyaW5nJyk7XG4gIH1cbn1cblxuY2xhc3MgTlNNdXRhYmxlRGF0YSBleHRlbmRzIEJhc2VBcmNoaXZlSGFuZGxlciB7XG4gIGRlY29kZUFyY2hpdmUoYXJjaGl2ZSkge1xuICAgIHJldHVybiBhcmNoaXZlLmRlY29kZSgnTlMuZGF0YScpO1xuICB9XG59XG5cbmNsYXNzIE5TVVVJRCBleHRlbmRzIEJhc2VBcmNoaXZlSGFuZGxlciB7XG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZGF0YSB1dWlkIGZvcm1hdCBkYXRhIGUuZzowMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDBcbiAgICovXG4gIGNvbnN0cnVjdG9yKGRhdGEpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xuICAgIHRoaXMuYWRkaXRpb25DbGFzc2VzID0gW05TX09CSkVDVF07XG4gIH1cblxuICBkZWNvZGVBcmNoaXZlKGFyY2hpdmUpIHtcbiAgICByZXR1cm4gdXVpZFN0cmluZ2lmeShhcmNoaXZlLmRlY29kZSgnTlMudXVpZGJ5dGVzJykpO1xuICB9XG5cbiAgZW5jb2RlQXJjaGl2ZShvYmosIGFyY2hpdmUpIHtcbiAgICBhcmNoaXZlLl9hcmNoaXZlT2JqWydOUy51dWlkYnl0ZXMnXSA9IEJ1ZmZlci5mcm9tKHV1aWRQYXJzZShvYmouX2RhdGEpLmJ1ZmZlcik7XG4gIH1cbn1cblxuY2xhc3MgWENUQ2FwYWJpbGl0aWVzIGV4dGVuZHMgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgZGVjb2RlQXJjaGl2ZShhcmNoaXZlKSB7XG4gICAgcmV0dXJuIGFyY2hpdmUuZGVjb2RlKCdjYXBhYmlsaXRpZXMtZGljdGlvbmFyeScpO1xuICB9XG59XG5cbi8qKlxuICogU29tZSBvZiB0aGUgcGxpc3QgY2xhc3NlcyBtYXkgbm90IGJlIGluY2x1ZGVkIGFuZCBzaG91bGQgbm90IGJlIGNhcmVkLlxuICogVXNpbmcgdGhpcyBhcyBhIGRlZmF1bHQgZGVjb2RlciBmb3IgdW5rbm93biBlbnRpdGllcyB0byBhdm9pZCBpbnRlcnJ1cHRpbmcgZGVjb2RlIHByb2Nlc3MuXG4gKi9cbmNsYXNzIE5TSWdub3JlIGV4dGVuZHMgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgZGVjb2RlQXJjaGl2ZSgpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5jbGFzcyBOU051bGwgZXh0ZW5kcyBCYXNlQXJjaGl2ZUhhbmRsZXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuYWRkaXRpb25DbGFzc2VzID0gW05TX09CSkVDVF07XG4gIH1cbiAgZGVjb2RlQXJjaGl2ZSgpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFhDVGVzdENvbmZpZ3VyYXRpb25QbGlzdFxuICogQHByb3BlcnR5IHtzdHJpbmcgfCBOU1VSTH0gdGVzdEJ1bmRsZVVSTFxuICogQHByb3BlcnR5IHtzdHJpbmcgfCBOU1VVSUR9IHNlc3Npb25JZGVudGlmaWVyXG4gKiBAcHJvcGVydHkge3N0cmluZz99IHByb2R1Y3RNb2R1bGVOYW1lXG4gKiBAcHJvcGVydHkge3N0cmluZz99IHRhcmdldEFwcGxpY2F0aW9uQnVuZGxlSURcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW10/fSB0YXJnZXRBcHBsaWNhdGlvbkFyZ3VtZW50c1xuICogQHByb3BlcnR5IHtzdHJpbmdbXT99IHRlc3RzVG9SdW5cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nW10/fSB0ZXN0c1RvU2tpcFxuICovXG5jbGFzcyBYQ1Rlc3RDb25maWd1cmF0aW9uIGV4dGVuZHMgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgc3RhdGljIF9kZWZhdWx0ID0ge1xuICAgIGFnZ3JlZ2F0ZVN0YXRpc3RpY3NCZWZvcmVDcmFzaDoge1xuICAgICAgWENTdWl0ZVJlY29yZHNLZXk6IHt9XG4gICAgfSxcbiAgICBhdXRvbWF0aW9uRnJhbWV3b3JrUGF0aDogJy9EZXZlbG9wZXIvTGlicmFyeS9Qcml2YXRlRnJhbWV3b3Jrcy9YQ1RBdXRvbWF0aW9uU3VwcG9ydC5mcmFtZXdvcmsnLFxuICAgIGJhc2VsaW5lRmlsZVJlbGF0aXZlUGF0aDogdW5kZWZpbmVkLFxuICAgIGJhc2VsaW5lRmlsZVVSTDogdW5kZWZpbmVkLFxuICAgIGRlZmF1bHRUZXN0RXhlY3V0aW9uVGltZUFsbG93YW5jZTogdW5kZWZpbmVkLFxuICAgIGRpc2FibGVQZXJmb3JtYW5jZU1ldHJpY3M6IGZhbHNlLFxuICAgIGVtaXRPU0xvZ3M6IGZhbHNlLFxuICAgIGZvcm1hdFZlcnNpb246IDIsXG4gICAgZ2F0aGVyTG9jYWxpemFibGVTdHJpbmdzRGF0YTogZmFsc2UsXG4gICAgaW5pdGlhbGl6ZUZvclVJVGVzdGluZzogdHJ1ZSxcbiAgICBtYXhpbXVtVGVzdEV4ZWN1dGlvblRpbWVBbGxvd2FuY2U6IHVuZGVmaW5lZCxcbiAgICBwcm9kdWN0TW9kdWxlTmFtZTogJ1dlYkRyaXZlckFnZW50UnVubmVyJyxcbiAgICByYW5kb21FeGVjdXRpb25PcmRlcmluZ1NlZWQ6IHVuZGVmaW5lZCxcbiAgICByZXBvcnRBY3Rpdml0aWVzOiB0cnVlLFxuICAgIHJlcG9ydFJlc3VsdHNUb0lERTogdHJ1ZSxcbiAgICBzeXN0ZW1BdHRhY2htZW50TGlmZXRpbWU6IDIsXG4gICAgdGFyZ2V0QXBwbGljYXRpb25Bcmd1bWVudHM6IFtdLFxuICAgIHRhcmdldEFwcGxpY2F0aW9uQnVuZGxlSUQ6IHVuZGVmaW5lZCxcbiAgICB0YXJnZXRBcHBsaWNhdGlvbkVudmlyb25tZW50OiB1bmRlZmluZWQsXG4gICAgdGFyZ2V0QXBwbGljYXRpb25QYXRoOiAnL0tFRVAtVEhJUy1OT1QtRU1QVFkvS0VFUC1USElTLU5PVC1FTVBUWScsXG4gICAgdGVzdEFwcGxpY2F0aW9uRGVwZW5kZW5jaWVzOiB7fSxcbiAgICB0ZXN0QXBwbGljYXRpb25Vc2VyT3ZlcnJpZGVzOiB1bmRlZmluZWQsXG4gICAgdGVzdEJ1bmRsZVJlbGF0aXZlUGF0aDogdW5kZWZpbmVkLFxuICAgIHRlc3RFeGVjdXRpb25PcmRlcmluZzogMCxcbiAgICB0ZXN0VGltZW91dHNFbmFibGVkOiBmYWxzZSxcbiAgICB0ZXN0c0RyaXZlbkJ5SURFOiBmYWxzZSxcbiAgICB0ZXN0c011c3RSdW5Pbk1haW5UaHJlYWQ6IHRydWUsXG4gICAgdGVzdHNUb1J1bjogdW5kZWZpbmVkLFxuICAgIHRlc3RzVG9Ta2lwOiB1bmRlZmluZWQsXG4gICAgdHJlYXRNaXNzaW5nQmFzZWxpbmVzQXNGYWlsdXJlczogZmFsc2UsXG4gICAgdXNlckF0dGFjaG1lbnRMaWZldGltZTogMVxuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7WENUZXN0Q29uZmlndXJhdGlvblBsaXN0fSBkYXRhXG4gICAqL1xuICBjb25zdHJ1Y3RvcihkYXRhKSB7XG4gICAgc3VwZXIoKTtcbiAgICBpZiAoIWRhdGEudGVzdEJ1bmRsZVVSTCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigndGVzdEJ1bmRsZVVSTCBjYW5ub3QgYmUgZW1wdHknKTtcbiAgICB9XG4gICAgaWYgKCFkYXRhLnNlc3Npb25JZGVudGlmaWVyKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdzZXNzaW9uSWRlbnRpZmllciBjYW5ub3QgYmUgZW1wdHknKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBkYXRhLnRlc3RCdW5kbGVVUkwgPT09ICdzdHJpbmcnKSB7XG4gICAgICBkYXRhLnRlc3RCdW5kbGVVUkwgPSBuZXcgTlNVUkwodW5kZWZpbmVkLCBkYXRhLnRlc3RCdW5kbGVVUkwpO1xuICAgIH1cbiAgICBpZiAoIShkYXRhLnRlc3RCdW5kbGVVUkwgaW5zdGFuY2VvZiBOU1VSTCkpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYEV4cGVjdGVkIHRlc3RCdW5kbGVVUkwgdG8gYmUgYSB2YWxpZCBOU1VSTCBpbnN0YW5jZSwgZ290ICR7ZGF0YS50ZXN0QnVuZGxlVVJMLmNvbnN0cnVjdG9yLm5hbWV9IGluc3RlYWRgKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBkYXRhLnNlc3Npb25JZGVudGlmaWVyID09PSAnc3RyaW5nJykge1xuICAgICAgZGF0YS5zZXNzaW9uSWRlbnRpZmllciA9IG5ldyBOU1VVSUQoZGF0YS5zZXNzaW9uSWRlbnRpZmllcik7XG4gICAgfVxuICAgIGlmICghKGRhdGEuc2Vzc2lvbklkZW50aWZpZXIgaW5zdGFuY2VvZiBOU1VVSUQpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBFeHBlY3RlZCBzZXNzaW9uSWRlbnRpZmllciB0byBiZSBhIHZhbGlkIE5TVVVJRCBpbnN0YW5jZSwgZ290ICR7ZGF0YS5zZXNzaW9uSWRlbnRpZmllci5jb25zdHJ1Y3Rvci5uYW1lfSBpbnN0ZWFkYCk7XG4gICAgfVxuICAgIHRoaXMuX2RhdGEgPSB7IC4uLlhDVGVzdENvbmZpZ3VyYXRpb24uX2RlZmF1bHQsIC4uLmRhdGEgfTtcbiAgfVxuXG4gIGdldEJ5dGVzKCkge1xuICAgIHJldHVybiBhcmNoaXZlKHRoaXMpO1xuICB9XG59XG5cbmNsYXNzIFhDQWN0aXZpdHlSZWNvcmQgZXh0ZW5kcyBCYXNlQXJjaGl2ZUhhbmRsZXIge1xuICBzdGF0aWMgX2tleXMgPSBbJ2FjdGl2aXR5VHlwZScsICdhdHRhY2htZW50cycsICdmaW5pc2gnLCAnc3RhcnQnLCAndGl0bGUnLCAndXVpZCddO1xuICBkZWNvZGVBcmNoaXZlKGFyY2hpdmUpIHtcbiAgICByZXR1cm4gWENBY3Rpdml0eVJlY29yZC5fa2V5cy5yZWR1Y2UoKGFjYywga2V5KSA9PiB7XG4gICAgICBhY2Nba2V5XSA9IGFyY2hpdmUuZGVjb2RlKGtleSk7XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcbiAgfVxufVxuXG4vKipcbiAqIGRlY29kZSBhbmQgZW5jb2RlIEFyY2hpdmUgb2YgY3VycmVudGx5IGtub3duIGRhdGEgZm9ybWF0c1xuICovXG5jb25zdCBVTkFSQ0hJVkVfQ0xBU1NfTUFQID0ge1xuICBEVFRhcE1lc3NhZ2VQbGlzdCxcbiAgRFRTeXNtb25UYXBNZXNzYWdlOiBEVFRhcE1lc3NhZ2VQbGlzdCxcbiAgRFRUYXBIZWFydGJlYXRNZXNzYWdlOiBEVFRhcE1lc3NhZ2VQbGlzdCxcbiAgRFRUYXBNZXNzYWdlQXJjaGl2ZTogRFRUYXBNZXNzYWdlUGxpc3QsXG4gIERUS1RyYWNlVGFwTWVzc2FnZTogRFRUYXBNZXNzYWdlUGxpc3QsXG4gIEVycm9yQXJjaGl2ZTogTlNFcnJvcixcbiAgRXhjZXB0aW9uQXJjaGl2ZTogTlNFeGNlcHRpb24sXG4gIE5TRGljdGlvbmFyeTogRGljdEFyY2hpdmUsXG4gIE5TTXV0YWJsZURpY3Rpb25hcnk6IERpY3RBcmNoaXZlLFxuICBOU0FycmF5OiBMaXN0QXJjaGl2ZSxcbiAgTlNNdXRhYmxlQXJyYXk6IExpc3RBcmNoaXZlLFxuICBOU011dGFibGVTZXQ6IExpc3RBcmNoaXZlLFxuICBOU1NldDogTGlzdEFyY2hpdmUsXG4gIE5TRGF0ZSxcbiAgTlNFcnJvcixcbiAgTlNFeGNlcHRpb24sXG4gIE5TTXV0YWJsZVN0cmluZyxcbiAgTlNNdXRhYmxlRGF0YSxcbiAgTlNOdWxsLFxuICBOU1VVSUQsXG4gIE5TVVJMLFxuICBYQ0FjdGl2aXR5UmVjb3JkLFxuICBYQ1RDYXBhYmlsaXRpZXMsXG4gIFhDVGVzdENvbmZpZ3VyYXRpb24sXG59O1xuXG4vKipcbiAqIENhcGFibGUgb2YgdW5wYWNraW5nIGFuIGFyY2hpdmVkIG9iamVjdCB0cmVlIGluIHRoZSBOU0tleWVkQXJjaGl2ZSBmb3JtYXQuXG4gKiBBcHBsZSdzIGltcGxlbWVudGF0aW9uIGNhbiBiZSBmb3VuZCBoZXJlOlxuICogaHR0cHM6Ly9naXRodWIuY29tL2FwcGxlL3N3aWZ0LWNvcmVsaWJzLWZvdW5kYXRpb24vYmxvYi9tYWluL1NvdXJjZXMvRm91bmRhdGlvbi9OU0tleWVkVW5hcmNoaXZlci5zd2lmdFxuICovXG5jbGFzcyBVbmFyY2hpdmUge1xuICBjb25zdHJ1Y3RvcihpbnB1dEJ5dGVzKSB7XG4gICAgdGhpcy5pbnB1dCA9IGlucHV0Qnl0ZXM7XG4gICAgdGhpcy51bnBhY2tlZFVpZHMgPSB7fTtcbiAgICB0aGlzLnRvcFVJRCA9IE5VTExfVUlEO1xuICAgIHRoaXMub2JqZWN0cyA9IFtdO1xuICB9XG5cbiAgdW5wYWNrQXJjaGl2ZUhlYWRlcigpIHtcbiAgICBjb25zdCBwbGlzdCA9IHBsaXN0bGliLnBhcnNlQnVmZmVyKHRoaXMuaW5wdXQpWzBdO1xuICAgIGlmIChwbGlzdC4kYXJjaGl2ZXIgIT09IE5TS0VZRURBUkNISVZFUikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGB1bnN1cHBvcnRlZCBlbmNvZGVyOiAke3BsaXN0LiRhcmNoaXZlcn1gKTtcbiAgICB9XG4gICAgaWYgKHBsaXN0LiR2ZXJzaW9uICE9PSBOU0tFWUVEX0FSQ0hJVkVfVkVSU0lPTikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBleHBlY3RlZCAke05TS0VZRURfQVJDSElWRV9WRVJTSU9OfSwgZ290ICR7cGxpc3QuJHZlcnNpb259YCk7XG4gICAgfVxuICAgIGNvbnN0IHRvcCA9IHBsaXN0LiR0b3A7XG4gICAgY29uc3QgdG9wVUlEID0gdG9wLnJvb3Q7XG4gICAgaWYgKCF0b3BVSUQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgdG9wIG9iamVjdCBkaWQgbm90IGhhdmUgYSBVSUQhIGR1bXA6ICR7SlNPTi5zdHJpbmdpZnkodG9wKX1gKTtcbiAgICB9XG4gICAgdGhpcy50b3BVSUQgPSB0b3BVSUQ7XG4gICAgdGhpcy5vYmplY3RzID0gcGxpc3QuJG9iamVjdHM7XG4gIH1cblxuICAvKipcbiAgICogdXNlIHRoZSBVTkFSQ0hJVkVfQ0xBU1NfTUFQIHRvIGZpbmQgdGhlIHVuYXJjaGl2aW5nIGRlbGVnYXRlIG9mIGEgdWlkXG4gICAqL1xuICBjbGFzc0ZvclVpZChpbmRleCkge1xuICAgIGNvbnN0IG1ldGEgPSB0aGlzLm9iamVjdHNbaW5kZXguVUlEXTtcbiAgICBjb25zdCBuYW1lID0gbWV0YS4kY2xhc3NuYW1lO1xuICAgIGNvbnN0IGtsYXNzID0gVU5BUkNISVZFX0NMQVNTX01BUFtuYW1lXSA/PyBOU0lnbm9yZTtcbiAgICByZXR1cm4ga2xhc3M7XG4gIH1cblxuICBkZWNvZGVLZXkob2JqLCBrZXkpIHtcbiAgICBjb25zdCB2YWwgPSBvYmpba2V5XTtcbiAgICByZXR1cm4gXy5pc05pbCh2YWw/LlVJRCkgPyB2YWwgOiB0aGlzLmRlY29kZU9iamVjdCh2YWwpO1xuICB9XG5cbiAgZGVjb2RlT2JqZWN0KGluZGV4KSB7XG4gICAgaWYgKGluZGV4ID09PSBOVUxMX1VJRCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IG9iaiA9IHRoaXMudW5wYWNrZWRVaWRzW2luZGV4XTtcbiAgICBpZiAob2JqID09PSBDWUNMRV9UT0tFTikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBhcmNoaXZlIGhhcyBhIGN5Y2xlIHdpdGggJHtpbmRleH1gKTtcbiAgICB9XG4gICAgaWYgKCFfLmlzVW5kZWZpbmVkKG9iaikpIHtcbiAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuICAgIGNvbnN0IHJhd09iaiA9IHRoaXMub2JqZWN0c1tpbmRleC5VSURdO1xuICAgIHRoaXMudW5wYWNrZWRVaWRzW2luZGV4LlVJRF0gPSBDWUNMRV9UT0tFTjtcblxuICAgIGlmICghcmF3T2JqPy4kY2xhc3MpIHtcbiAgICAgIHRoaXMudW5wYWNrZWRVaWRzW2luZGV4LlVJRF0gPSBvYmo7XG4gICAgICByZXR1cm4gcmF3T2JqO1xuICAgIH1cbiAgICBjb25zdCBrbGFzcyA9IHRoaXMuY2xhc3NGb3JVaWQocmF3T2JqLiRjbGFzcyk7XG4gICAgY29uc3Qga2xhc3NPYmogPSBuZXcga2xhc3MoKS5kZWNvZGVBcmNoaXZlKG5ldyBBcmNoaXZlZE9iamVjdChyYXdPYmosIHRoaXMpKTtcbiAgICB0aGlzLnVucGFja2VkVWlkc1tpbmRleC5VSURdID0ga2xhc3NPYmo7XG4gICAgcmV0dXJuIGtsYXNzT2JqO1xuICB9XG5cbiAgdG9PYmplY3QoKSB7XG4gICAgdGhpcy51bnBhY2tBcmNoaXZlSGVhZGVyKCk7XG4gICAgcmV0dXJuIHRoaXMuZGVjb2RlT2JqZWN0KHRoaXMudG9wVUlEKTtcbiAgfVxufVxuXG4vKipcbiAqIENhcGFibGUgb2YgcGFja2luZyBhbiBvYmplY3QgdHJlZSBpbnRvIHRoZSBOU0tleWVkQXJjaGl2ZSBmb3JtYXQuXG4gKiBBcHBsZSdzIGltcGxlbWVudGF0aW9uIGNhbiBiZSBmb3VuZCBoZXJlOlxuICogaHR0cHM6Ly9naXRodWIuY29tL2FwcGxlL3N3aWZ0LWNvcmVsaWJzLWZvdW5kYXRpb24vYmxvYi9tYWluL1NvdXJjZXMvRm91bmRhdGlvbi9OU0tleWVkQXJjaGl2ZXIuc3dpZnRcbiAqL1xuY2xhc3MgQXJjaGl2ZSB7XG4gIGNvbnN0cnVjdG9yKGlucHV0T2JqZWN0KSB7XG4gICAgdGhpcy5pbnB1dCA9IGlucHV0T2JqZWN0O1xuICAgIHRoaXMub2JqZWN0cyA9IFsnJG51bGwnXTsgLy8gb2JqZWN0cyB0aGF0IGdvIGRpcmVjdGx5IGludG8gdGhlIGFyY2hpdmUsIGFsd2F5cyBzdGFydCB3aXRoICRudWxsXG4gIH1cblxuICB1aWRGb3JBcmNoaXZlcihhcmNoaXZlciwgLi4uYWRkaXRpb24pIHtcbiAgICBjb25zdCB2YWwgPSBuZXcgcGxpc3RsaWIuVUlEKHRoaXMub2JqZWN0cy5sZW5ndGgpO1xuICAgIHRoaXMub2JqZWN0cy5wdXNoKHtcbiAgICAgICRjbGFzc2VzOiBbYXJjaGl2ZXIsIC4uLmFkZGl0aW9uXSxcbiAgICAgICRjbGFzc25hbWU6IGFyY2hpdmVyXG4gICAgfSk7XG4gICAgcmV0dXJuIHZhbDtcbiAgfVxuXG4gIGFyY2hpdmUob2JqKSB7XG4gICAgaWYgKF8uaXNVbmRlZmluZWQob2JqKSB8fCBfLmlzTnVsbChvYmopKSB7XG4gICAgICByZXR1cm4gTlVMTF9VSUQ7XG4gICAgfVxuICAgIGNvbnN0IGluZGV4ID0gbmV3IHBsaXN0bGliLlVJRCh0aGlzLm9iamVjdHMubGVuZ3RoKTtcbiAgICBpZiAoUFJJTUlUSVZFX1RZUEVTLmluY2x1ZGVzKG9iai5jb25zdHJ1Y3Rvci5uYW1lKSkge1xuICAgICAgdGhpcy5vYmplY3RzLnB1c2gob2JqKTtcbiAgICAgIHJldHVybiBpbmRleDtcbiAgICB9XG4gICAgY29uc3QgYXJjaGl2ZU9iaiA9IHt9O1xuICAgIHRoaXMub2JqZWN0cy5wdXNoKGFyY2hpdmVPYmopO1xuICAgIHRoaXMuZW5jb2RlVG9wTGV2ZWwob2JqLCBhcmNoaXZlT2JqKTtcbiAgICByZXR1cm4gaW5kZXg7XG4gIH1cblxuICBlbmNvZGUodmFsKSB7XG4gICAgaWYgKE5PTl9FTkNPREFCTEVfVFlQRVMuaW5jbHVkZXModHlwZW9mIHZhbCkpIHtcbiAgICAgIHJldHVybiB2YWw7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmFyY2hpdmUodmFsKTtcbiAgfVxuXG4gIGVuY29kZVRvcExldmVsKG9iaiwgYXJjaGl2ZU9iaikge1xuICAgIGlmIChvYmogaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlQXJyYXkob2JqLCBhcmNoaXZlT2JqKTtcbiAgICB9IGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIFNldCkge1xuICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlU2V0KG9iaiwgYXJjaGl2ZU9iaik7XG4gICAgfSBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBYQ1Rlc3RDb25maWd1cmF0aW9uKSB7XG4gICAgICByZXR1cm4gdGhpcy5lbmNvZGVYQ1Rlc3RDb25maWd1cmF0aW9uKG9iaiwgYXJjaGl2ZU9iaik7XG4gICAgfSBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBPYmplY3QpIHtcbiAgICAgIGNvbnN0IG9iak5hbWUgPSBvYmouY29uc3RydWN0b3IubmFtZTtcbiAgICAgIC8vIE9ubHkgc3BlY2lhbCBjbGFzcyBpbnN0YW5jZSBhcmUgdXNlZnVsLCBzdWNoIGFzIE5TVVJMLCBOU1VVSUQsIE5TRGF0ZS5cbiAgICAgIC8vIEFuZCB0aGlzIGNsYXNzIG11c3QgYWxzbyBoYXZlIHRoZSBlbmNvZGVBcmNoaXZlIG1ldGhvZFxuICAgICAgaWYgKG9iak5hbWUgaW4gVU5BUkNISVZFX0NMQVNTX01BUCkge1xuICAgICAgICBvYmouZW5jb2RlQXJjaGl2ZShvYmosIG5ldyBBcmNoaXZpbmdPYmplY3QoYXJjaGl2ZU9iaiwgdGhpcykpO1xuICAgICAgICBhcmNoaXZlT2JqLiRjbGFzcyA9IHRoaXMudWlkRm9yQXJjaGl2ZXIob2JqTmFtZSwgLi4uKG9iai5hZGRpdGlvbkNsYXNzZXMgPz8gW10pKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVuY29kZURpY3Qob2JqLCBhcmNoaXZlT2JqKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gZW5jb2RlIHR5cGVzOiAke3N0cmluZ0Zvcm1hdCgnJU8nLCBvYmopfWApO1xuICAgIH1cbiAgfVxuXG4gIGVuY29kZUFycmF5KG9ianMsIGFyY2hpdmVPYmopIHtcbiAgICBhcmNoaXZlT2JqLiRjbGFzcyA9IHRoaXMudWlkRm9yQXJjaGl2ZXIoJ05TQXJyYXknLCBOU19PQkpFQ1QpO1xuICAgIGFyY2hpdmVPYmpbJ05TLm9iamVjdHMnXSA9IG9ianMubWFwKHRoaXMuYXJjaGl2ZS5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIGVuY29kZVNldChvYmpzLCBhcmNoaXZlT2JqKSB7XG4gICAgYXJjaGl2ZU9iai4kY2xhc3MgPSB0aGlzLnVpZEZvckFyY2hpdmVyKCdOU1NldCcsIE5TX09CSkVDVCk7XG4gICAgYXJjaGl2ZU9ialsnTlMub2JqZWN0cyddID0gb2Jqcy5tYXAodGhpcy5hcmNoaXZlLmJpbmQodGhpcykpO1xuICB9XG5cbiAgZW5jb2RlRGljdChvYmosIGFyY2hpdmVPYmopIHtcbiAgICBhcmNoaXZlT2JqWydOUy5rZXlzJ10gPSBfLmtleXMob2JqKS5tYXAodGhpcy5hcmNoaXZlLmJpbmQodGhpcykpO1xuICAgIGFyY2hpdmVPYmpbJ05TLm9iamVjdHMnXSA9IF8udmFsdWVzKG9iaikubWFwKHRoaXMuYXJjaGl2ZS5iaW5kKHRoaXMpKTtcbiAgICAvL2RpY3QgaGFzIHRvIG1ha2UgY2xhc3NlcyBhZnRlciB2YWx1ZVxuICAgIGFyY2hpdmVPYmouJGNsYXNzID0gdGhpcy51aWRGb3JBcmNoaXZlcignTlNEaWN0aW9uYXJ5JywgTlNfT0JKRUNUKTtcbiAgfVxuXG4gIC8qKlxuICAgKlxuICAgKiBAcGFyYW0ge1hDVGVzdENvbmZpZ3VyYXRpb259IG9ialxuICAgKiBAcGFyYW0geyp9IGFyY2hpdmVPYmpcbiAgICovXG4gIGVuY29kZVhDVGVzdENvbmZpZ3VyYXRpb24ob2JqLCBhcmNoaXZlT2JqKSB7XG4gICAgYXJjaGl2ZU9iai4kY2xhc3MgPSB0aGlzLnVpZEZvckFyY2hpdmVyKCdYQ1Rlc3RDb25maWd1cmF0aW9uJywgTlNfT0JKRUNUKTtcbiAgICBfLmVudHJpZXMob2JqLl9kYXRhKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IGFyY2hpdmVPYmpba2V5XSA9IChrZXkgPT09IEZPUk1BVF9WRVJTSU9OKSA/IHRoaXMuYXJjaGl2ZSh2YWx1ZSkgOiB0aGlzLmVuY29kZSh2YWx1ZSkpO1xuICB9XG5cbiAgdG9CeXRlcygpIHtcbiAgICBpZiAodGhpcy5vYmplY3RzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgdGhpcy5hcmNoaXZlKHRoaXMuaW5wdXQpO1xuICAgIH1cbiAgICBjb25zdCBkID0ge1xuICAgICAgJHZlcnNpb246IE5TS0VZRURfQVJDSElWRV9WRVJTSU9OLFxuICAgICAgJGFyY2hpdmVyOiBOU0tFWUVEQVJDSElWRVIsXG4gICAgICAkdG9wOiB7IHJvb3Q6IG5ldyBwbGlzdGxpYi5VSUQoMSkgfSxcbiAgICAgICRvYmplY3RzOiB0aGlzLm9iamVjdHNcbiAgICB9O1xuICAgIHJldHVybiBicGxpc3RDcmVhdGUoZCk7XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIE5TS2V5ZWQgQnVmZmVyIGZyb20gYW4gb2JqZWN0XG4gKiBAcGFyYW0ge09iamVjdH0gaW5wdXRPYmplY3RcbiAqIEByZXR1cm5zIHtCdWZmZXJ9IE5TS2V5ZWQgQnVmZmVyXG4gKi9cbmZ1bmN0aW9uIGFyY2hpdmUoaW5wdXRPYmplY3QpIHtcbiAgcmV0dXJuIG5ldyBBcmNoaXZlKGlucHV0T2JqZWN0KS50b0J5dGVzKCk7XG59XG5cbi8qKlxuICogUGFyc2VzIE5TS2V5ZWQgQnVmZmVyIGludG8gSlMgT2JqZWN0XG4gKiBAcGFyYW0ge0J1ZmZlcn0gaW5wdXRCeXRlcyBOU0tleWVkIEJ1ZmZlclxuICogQHJldHVybnMge09iamVjdH0gSlMgT2JqZWN0XG4gKi9cbmZ1bmN0aW9uIHVuYXJjaGl2ZShpbnB1dEJ5dGVzKSB7XG4gIHJldHVybiBuZXcgVW5hcmNoaXZlKGlucHV0Qnl0ZXMpLnRvT2JqZWN0KCk7XG59XG5cbi8qKlxuICogVXBkYXRlIHVua25vd24gTlNLZXllZEFyY2hpdmUgdHlwZXMgZm9yIHBhY2tpbmcvdW5wYWNraW5nXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBwYWNraW5nL3VucGFja2luZyBrZXkgbmFtZVxuICogQHBhcmFtIHtCYXNlQXJjaGl2ZUhhbmRsZXJ9IHN1YkNsYXNzIGluaGVyaXQgZnJvbSBCYXNlQXJjaGl2ZUhhbmRsZXIgY2xhc3NcbiAqL1xuZnVuY3Rpb24gdXBkYXRlTlNLZXllZEFyY2hpdmVDbGFzcyhuYW1lLCBzdWJDbGFzcykge1xuICBpZiAoIV8uaXNGdW5jdGlvbihzdWJDbGFzcy5wcm90b3R5cGU/LmRlY29kZUFyY2hpdmUpICYmICFfLmlzRnVuY3Rpb24oc3ViQ2xhc3MucHJvdG90eXBlPy5lbmNvZGVBcmNoaXZlKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignc3ViQ2xhc3MgbXVzdCBoYXZlIGRlY29kZUFyY2hpdmUgb3IgZW5jb2RlQXJjaGl2ZSBtZXRob2RzJyk7XG4gIH1cbiAgaWYgKCEobmFtZSBpbiBVTkFSQ0hJVkVfQ0xBU1NfTUFQKSkge1xuICAgIFVOQVJDSElWRV9DTEFTU19NQVBbbmFtZV0gPSBzdWJDbGFzcztcbiAgfVxufVxuXG5leHBvcnQgeyB1cGRhdGVOU0tleWVkQXJjaGl2ZUNsYXNzLCBCYXNlQXJjaGl2ZUhhbmRsZXIsIE5TVVJMLCBOU1VVSUQsIE5TRGF0ZSwgWENUZXN0Q29uZmlndXJhdGlvbiwgdW5hcmNoaXZlLCBhcmNoaXZlIH07XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEsSUFBQUEsYUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsY0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsS0FBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsT0FBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksU0FBQSxHQUFBSixPQUFBO0FBRUEsTUFBTUssdUJBQXVCLEdBQUcsT0FBTztBQUN2QyxNQUFNQyxRQUFRLEdBQUcsSUFBSUMscUJBQVEsQ0FBQ0Ms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